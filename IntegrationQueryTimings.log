** Query 1 **

"Limit  (cost=100494.98..100494.99 rows=5 width=45) (actual time=173.485..173.488 rows=5 loops=1)"
"  ->  Sort  (cost=100494.98..101796.32 rows=520538 width=45) (actual time=173.483..173.486 rows=5 loops=1)"
"        Sort Key: codesharerevenue.totalrevenue DESC"
"        Sort Method: top-N heapsort  Memory: 25kB"
"        ->  Subquery Scan on codesharerevenue  (cost=71271.51..91849.03 rows=520538 width=45) (actual time=172.605..173.164 rows=2779 loops=1)"
"              ->  HashAggregate  (cost=71271.51..86643.65 rows=520538 width=59) (actual time=172.603..173.040 rows=2779 loops=1)"
"                    Group Key: cs.codeshareid, f.flightnumber, f.departuredate, fi.flightcode"
"                    Planned Partitions: 16  Batches: 1  Memory Usage: 2065kB"
"                    ->  Hash Join  (cost=260.43..13686.99 rows=520538 width=51) (actual time=7.742..99.141 rows=574448 loops=1)"
"                          Hash Cond: (t.flightid = f.flightid)"
"                          ->  Seq Scan on ticket t  (cost=0.00..6912.86 rows=348886 width=12) (actual time=0.011..14.553 rows=348886 loops=1)"
"                          ->  Hash  (cost=223.13..223.13 rows=2984 width=47) (actual time=7.714..7.715 rows=2907 loops=1)"
"                                Buckets: 4096  Batches: 1  Memory Usage: 264kB"
"                                ->  Hash Join  (cost=131.32..223.13 rows=2984 width=47) (actual time=2.196..5.440 rows=2907 loops=1)"
"                                      Hash Cond: (f.flightnumber = cs.flightnumber)"
"                                      ->  Hash Join  (cost=4.25..53.72 rows=2000 width=26) (actual time=0.121..1.329 rows=2000 loops=1)"
"                                            Hash Cond: ((f.flightcode)::text = (fi.flightcode)::text)"
"                                            ->  Seq Scan on flight f  (cost=0.00..44.00 rows=2000 width=18) (actual time=0.034..0.265 rows=2000 loops=1)"
"                                            ->  Hash  (cost=3.00..3.00 rows=100 width=14) (actual time=0.072..0.073 rows=100 loops=1)"
"                                                  Buckets: 1024  Batches: 1  Memory Usage: 13kB"
"                                                  ->  Seq Scan on flightinfo fi  (cost=0.00..3.00 rows=100 width=14) (actual time=0.009..0.034 rows=100 loops=1)"
"                                      ->  Hash  (cost=77.03..77.03 rows=4003 width=25) (actual time=2.059..2.059 rows=4003 loops=1)"
"                                            Buckets: 4096  Batches: 1  Memory Usage: 263kB"
"                                            ->  Seq Scan on codeshare cs  (cost=0.00..77.03 rows=4003 width=25) (actual time=0.007..0.922 rows=4003 loops=1)"
"Planning Time: 3.749 ms"
"Execution Time: 174.418 ms"



** Query 2-4 **

These queries didn't run because these operations can't be performed on views with group by.



** Query 5 **

"Hash Join  (cost=73.25..7164.05 rows=33154 width=20) (actual time=27.275..51.468 rows=77587 loops=1)"
"  Hash Cond: ((f.flightcode)::text = (fi.flightcode)::text)"
"  ->  Hash Join  (cost=69.00..7069.08 rows=33154 width=22) (actual time=27.176..44.252 rows=77587 loops=1)"
"        Hash Cond: (t.flightid = f.flightid)"
"        ->  Seq Scan on ticket t  (cost=0.00..6912.86 rows=33154 width=12) (actual time=26.866..37.149 rows=77587 loops=1)"
"              Filter: ((status IS NOT NULL) AND (bookingid IS NOT NULL))"
"              Rows Removed by Filter: 271299"
"        ->  Hash  (cost=44.00..44.00 rows=2000 width=18) (actual time=0.283..0.284 rows=2000 loops=1)"
"              Buckets: 2048  Batches: 1  Memory Usage: 116kB"
"              ->  Seq Scan on flight f  (cost=0.00..44.00 rows=2000 width=18) (actual time=0.016..0.126 rows=2000 loops=1)"
"  ->  Hash  (cost=3.00..3.00 rows=100 width=10) (actual time=0.091..0.091 rows=100 loops=1)"
"        Buckets: 1024  Batches: 1  Memory Usage: 13kB"
"        ->  Seq Scan on flightinfo fi  (cost=0.00..3.00 rows=100 width=10) (actual time=0.013..0.050 rows=100 loops=1)"
"Planning Time: 0.798 ms"
"Execution Time: 53.096 ms"



** Query 6-8 **

These queries didn't run because these operations can't be performed on views that select from multiple tables.



** Query 9 **

"Sort  (cost=98365.90..98366.40 rows=200 width=25) (actual time=175.452..175.457 rows=136 loops=1)"
"  Sort Key: (avg(((sum(t.price)) / ((count(t.ticketid)))::double precision))) DESC"
"  Sort Method: quicksort  Memory: 32kB"
"  ->  HashAggregate  (cost=98355.75..98358.25 rows=200 width=25) (actual time=175.412..175.422 rows=136 loops=1)"
"        Group Key: cs.marketingairline"
"        Batches: 1  Memory Usage: 64kB"
"        ->  HashAggregate  (cost=72572.85..87944.99 rows=520538 width=59) (actual time=174.662..175.087 rows=2779 loops=1)"
"              Group Key: cs.codeshareid, f.flightnumber, f.departuredate, fi.flightcode"
"              Planned Partitions: 16  Batches: 1  Memory Usage: 2065kB"
"              ->  Hash Join  (cost=260.43..13686.99 rows=520538 width=55) (actual time=8.648..98.448 rows=574448 loops=1)"
"                    Hash Cond: (t.flightid = f.flightid)"
"                    ->  Seq Scan on ticket t  (cost=0.00..6912.86 rows=348886 width=16) (actual time=0.011..11.832 rows=348886 loops=1)"
"                    ->  Hash  (cost=223.13..223.13 rows=2984 width=47) (actual time=8.626..8.628 rows=2907 loops=1)"
"                          Buckets: 4096  Batches: 1  Memory Usage: 264kB"
"                          ->  Hash Join  (cost=131.32..223.13 rows=2984 width=47) (actual time=2.890..6.188 rows=2907 loops=1)"
"                                Hash Cond: (f.flightnumber = cs.flightnumber)"
"                                ->  Hash Join  (cost=4.25..53.72 rows=2000 width=26) (actual time=0.123..1.973 rows=2000 loops=1)"
"                                      Hash Cond: ((f.flightcode)::text = (fi.flightcode)::text)"
"                                      ->  Seq Scan on flight f  (cost=0.00..44.00 rows=2000 width=18) (actual time=0.014..0.439 rows=2000 loops=1)"
"                                      ->  Hash  (cost=3.00..3.00 rows=100 width=14) (actual time=0.094..0.094 rows=100 loops=1)"
"                                            Buckets: 1024  Batches: 1  Memory Usage: 13kB"
"                                            ->  Seq Scan on flightinfo fi  (cost=0.00..3.00 rows=100 width=14) (actual time=0.011..0.045 rows=100 loops=1)"
"                                ->  Hash  (cost=77.03..77.03 rows=4003 width=25) (actual time=2.748..2.748 rows=4003 loops=1)"
"                                      Buckets: 4096  Batches: 1  Memory Usage: 263kB"
"                                      ->  Seq Scan on codeshare cs  (cost=0.00..77.03 rows=4003 width=25) (actual time=0.008..1.189 rows=4003 loops=1)"
"Planning Time: 1.174 ms"
"Execution Time: 175.992 ms"



** Query 10 **

"Aggregate  (cost=93160.37..93160.38 rows=1 width=8) (actual time=251.209..251.211 rows=1 loops=1)"
"  ->  HashAggregate  (cost=71281.51..86653.65 rows=520538 width=59) (actual time=250.730..251.141 rows=2779 loops=1)"
"        Group Key: cs.codeshareid, f.flightnumber, f.departuredate, fi.flightcode"
"        Planned Partitions: 16  Batches: 1  Memory Usage: 2065kB"
"        ->  Hash Join  (cost=270.43..13696.99 rows=520538 width=51) (actual time=7.890..139.846 rows=574448 loops=1)"
"              Hash Cond: (t.flightid = f.flightid)"
"              ->  Seq Scan on ticket t  (cost=0.00..6912.86 rows=348886 width=12) (actual time=0.012..17.291 rows=348886 loops=1)"
"              ->  Hash  (cost=233.13..233.13 rows=2984 width=47) (actual time=7.871..7.872 rows=2907 loops=1)"
"                    Buckets: 4096  Batches: 1  Memory Usage: 264kB"
"                    ->  Hash Join  (cost=131.32..233.13 rows=2984 width=47) (actual time=2.867..6.199 rows=2907 loops=1)"
"                          Hash Cond: (f.flightnumber = cs.flightnumber)"
"                          ->  Hash Join  (cost=4.25..63.72 rows=2000 width=26) (actual time=0.116..2.146 rows=2000 loops=1)"
"                                Hash Cond: ((f.flightcode)::text = (fi.flightcode)::text)"
"                                ->  Seq Scan on flight f  (cost=0.00..54.00 rows=2000 width=18) (actual time=0.019..0.624 rows=2000 loops=1)"
"                                      Filter: ((departuredate >= '2024-01-01'::date) AND (departuredate <= '2024-12-31'::date))"
"                                ->  Hash  (cost=3.00..3.00 rows=100 width=14) (actual time=0.088..0.088 rows=100 loops=1)"
"                                      Buckets: 1024  Batches: 1  Memory Usage: 13kB"
"                                      ->  Seq Scan on flightinfo fi  (cost=0.00..3.00 rows=100 width=14) (actual time=0.007..0.040 rows=100 loops=1)"
"                          ->  Hash  (cost=77.03..77.03 rows=4003 width=25) (actual time=2.742..2.743 rows=4003 loops=1)"
"                                Buckets: 4096  Batches: 1  Memory Usage: 263kB"
"                                ->  Seq Scan on codeshare cs  (cost=0.00..77.03 rows=4003 width=25) (actual time=0.008..1.182 rows=4003 loops=1)"
"Planning Time: 1.209 ms"
"Execution Time: 251.563 ms"



** Query 11 **

"Gather  (cost=1073.25..6520.05 rows=2012 width=16) (actual time=25.383..31.377 rows=11325 loops=1)"
"  Workers Planned: 2"
"  Workers Launched: 2"
"  ->  Hash Join  (cost=73.25..5318.85 rows=838 width=16) (actual time=17.366..22.099 rows=3775 loops=3)"
"        Hash Cond: ((f.flightcode)::text = (fi.flightcode)::text)"
"        ->  Hash Join  (cost=69.00..5312.31 rows=838 width=18) (actual time=17.088..21.464 rows=3775 loops=3)"
"              Hash Cond: (t.flightid = f.flightid)"
"              ->  Parallel Seq Scan on ticket t  (cost=0.00..5241.11 rows=838 width=8) (actual time=16.710..20.687 rows=3775 loops=3)"
"                    Filter: ((status IS NOT NULL) AND (bookingid IS NOT NULL) AND (status = 'Booked'::ticket_status))"
"                    Rows Removed by Filter: 112520"
"              ->  Hash  (cost=44.00..44.00 rows=2000 width=18) (actual time=0.344..0.344 rows=2000 loops=3)"
"                    Buckets: 2048  Batches: 1  Memory Usage: 116kB"
"                    ->  Seq Scan on flight f  (cost=0.00..44.00 rows=2000 width=18) (actual time=0.072..0.191 rows=2000 loops=3)"
"        ->  Hash  (cost=3.00..3.00 rows=100 width=10) (actual time=0.139..0.139 rows=100 loops=3)"
"              Buckets: 1024  Batches: 1  Memory Usage: 13kB"
"              ->  Seq Scan on flightinfo fi  (cost=0.00..3.00 rows=100 width=10) (actual time=0.057..0.100 rows=100 loops=3)"
"Planning Time: 0.696 ms"
"Execution Time: 31.632 ms"



** Query 12 **

"Gather  (cost=1073.25..6606.77 rows=2860 width=28) (actual time=31.465..37.843 rows=15410 loops=1)"
"  Workers Planned: 2"
"  Workers Launched: 2"
"  ->  Hash Join  (cost=73.25..5320.77 rows=1192 width=28) (actual time=22.096..27.088 rows=5137 loops=3)"
"        Hash Cond: ((f.flightcode)::text = (fi.flightcode)::text)"
"        ->  Hash Join  (cost=69.00..5313.25 rows=1192 width=30) (actual time=21.801..26.297 rows=5137 loops=3)"
"              Hash Cond: (t.flightid = f.flightid)"
"              ->  Parallel Seq Scan on ticket t  (cost=0.00..5241.11 rows=1192 width=20) (actual time=21.110..25.075 rows=5137 loops=3)"
"                    Filter: ((status IS NOT NULL) AND (bookingid IS NOT NULL) AND (price > '800'::double precision))"
"                    Rows Removed by Filter: 111159"
"              ->  Hash  (cost=44.00..44.00 rows=2000 width=18) (actual time=0.645..0.646 rows=2000 loops=3)"
"                    Buckets: 2048  Batches: 1  Memory Usage: 116kB"
"                    ->  Seq Scan on flight f  (cost=0.00..44.00 rows=2000 width=18) (actual time=0.081..0.317 rows=2000 loops=3)"
"        ->  Hash  (cost=3.00..3.00 rows=100 width=10) (actual time=0.137..0.138 rows=100 loops=3)"
"              Buckets: 1024  Batches: 1  Memory Usage: 13kB"
"              ->  Seq Scan on flightinfo fi  (cost=0.00..3.00 rows=100 width=10) (actual time=0.063..0.096 rows=100 loops=3)"
"Planning Time: 0.746 ms"
"Execution Time: 38.287 ms"